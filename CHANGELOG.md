# История изменений (Changelog)

## [1.0.0] - 2024-05-17
### Добавлено
- Настроена непрерывная интеграция (CI) с GitHub Actions
- Добавлено автоматическое тестирование для проверки кода
- Сбор и отчетность о покрытии кода тестами через Coverlet и ReportGenerator
- Проверка минимального порога покрытия (65%) на этапе CI
- Добавлены файлы CHANGELOG.md и TESTING.md для документирования изменений и инструкций по тестированию

### Исправлено
- Исправлена ошибка в тесте `Upload_NullFile_ReturnsBadRequest()` с использованием `null!`
- Синхронизированы версии EF Core между основными проектами и тестами (обновлено до 9.0.1)
- Исправлена регистрация контекста базы данных в тестах для устранения конфликтов между провайдерами PostgreSQL и InMemory
- Исправлена проблема с загрузкой отчетов о покрытии кода в Codecov (файлы сохраняются в отдельную директорию)
- Добавлена поддержка токена Codecov для решения проблемы ограничения запросов (Rate Limit)

### Изменено
- Добавлена переменная окружения `SKIP_DB_MIGRATION` для условного пропуска миграций в тестовом режиме
- Исключены файлы миграций из анализа покрытия кода для достижения корректного показателя
- Модернизированы тесты для `Program.cs` в обоих сервисах для увеличения покрытия кода
- Обновлен `.gitignore` для исключения файлов отчетов о покрытии кода (`coveragereport/` и `*.opencover.xml`)

### Статистика
- Текущее покрытие кода тестами: 85.9% (превышает требуемый порог в 65%)

## Запланированные улучшения
- Мониторинг сервисов с использованием Health Checks
- Дополнительные автоматизированные тесты для API Gateway
- Расширение документации по API с более подробными примерами
- Сбор метрик производительности

## Руководство по разработке
- При внесении изменений в проект рекомендуется сначала запускать тесты локально
- Для проверки покрытия кода можно использовать: `dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=opencover`
- При добавлении новых миграций необходимо обновить логику пропуска миграций в тестовом режиме
